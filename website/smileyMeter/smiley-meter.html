<!DOCTYPE html>
<html>
  <head>
    <title>Aft Offsite 2019</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <!-- Load c3.css -->
    <link href="/path/to/c3.css" rel="stylesheet">

<!-- Load d3.js and c3.js -->
<script src="/path/to/d3.v5.min.js" charset="utf-8"></script>
<script src="/path/to/c3.min.js"></script>
  </head>
  <body>
    <div class="hero-unit">
        <h1>AFT Offsite 2019 !</h1>
        <h2>SmileyMeter :)</h2>
        <h3>The more you smile, the more you score</h3>
    </div>
    <script src="../jquery-3.3.1.min.js"></script>
    <script src="../bootstrap/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>

	<input type="button" value="Refresh" id="button"/>
    <div id="div1">
        
    </div>
    <div>
        <canvas id="myChart" width="400" height="400"></canvas>
    </div>
    
    <script>
	
	$(document).ready(function(){
	  $("#button").click(function(){
	    alert("Hi");
		$.ajax({url: "https://5xj5iacnnl.execute-api.us-west-2.amazonaws.com/prod/smiles", 
		dataType: "json",
		success: function(result){
		  addData(result);
		}, error:  function(xhr,status,error){
		  $("#div1").html(error);
		}});
	  });
	});
	
    var ctx = document.getElementById("myChart").getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'horizontalBar',
        data: {
            labels: [],
			datasets: [{
                label: 'SmileyMeter !',
                data: [],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(54, 162, 235, 0.2)',
                    'rgba(255, 206, 86, 0.2)',
                    'rgba(75, 192, 192, 0.2)',
                    'rgba(153, 102, 255, 0.2)',
                    'rgba(255, 159, 64, 0.2)'
                ],
                borderColor: [
                    'rgba(255,99,132,1)',
                    'rgba(54, 162, 235, 1)',
                    'rgba(255, 206, 86, 1)',
                    'rgba(75, 192, 192, 1)',
                    'rgba(153, 102, 255, 1)',
                    'rgba(255, 159, 64, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero:true
                    }
                }]
            }
        }
    });
	
	function addData(result) {
	    //chart, label, data
		//alert("Hi");
		myChart.clear();
		for (i in result.body.Items) {
			myChart.data.labels.push(result.body.Items[i].UserId);
		}
		//$("#div1").html(label);
		myChart.data.datasets.forEach((dataset) => {
			for (i in result.body.Items) {
				dataset.data.push(result.body.Items[i].score);
				//dataset.data.label.push(result.body.Items[i].UserId);
			}
			
		});
		myChart.update();
    }

    </script>
  </body>
</html>
