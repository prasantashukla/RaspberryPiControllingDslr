<!DOCTYPE html>
<html>
  <head>
    <title>Aft Offsite 2019</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <!-- Load c3.css -->
    <link href="/path/to/c3.css" rel="stylesheet">

<!-- Load d3.js and c3.js -->
<script src="/path/to/d3.v5.min.js" charset="utf-8"></script>
<script src="/path/to/c3.min.js"></script>
  </head>
  <body>
    <div class="hero-unit">
        <h1>AFT Offsite 2019 !</h1>
        <h2>SmileyMeter :)</h2>
        <h3>The more you smile, the more you score</h3>
    </div>
    <script src="../jquery-3.3.1.min.js"></script>
    <script src="../bootstrap/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>

	<input type="button" value="Refresh" id="button"/>
    <div id="div1">
        
    </div>
    <div>
        <canvas id="myChart" width="100" height="100"></canvas>
    </div>
    
    <script>
	
	var backgroundColor = [
		'rgba(255, 99, 132, .5)',
		'rgba(54, 162, 235, .5)',
		'rgba(255, 206, 86, .5)',
		'rgba(75, 192, 192, .5)',
		'rgba(153, 102, 255, .5)',
		'rgba(255, 159, 64, .5)',
		'rgba(255, 206, 86, .5)',
		'rgba(75, 192, 192, .5)',
		'rgba(140, 102, 255, .5)',
		'rgba(255, 210, 64, .5)'
	];

    var borderColor = [
		'rgba(255, 99, 132, 1)',
		'rgba(54, 162, 235, 1)',
		'rgba(255, 206, 86, 1)',
		'rgba(75, 192, 192, 1)',
		'rgba(153, 102, 255, 1)',
		'rgba(255, 159, 64, 1)',
		'rgba(255, 206, 86, 1)',
		'rgba(75, 192, 192, 1)',
		'rgba(140, 102, 255, 1)',
		'rgba(255, 210, 64, 1)'
    ];
	
	$(document).ready(function(){
	  $("#button").click(function(){
		$.ajax({url: "https://5xj5iacnnl.execute-api.us-west-2.amazonaws.com/prod/smiles", 
		dataType: "json",
		success: function(result){
		  addData(result);
		}, error:  function(xhr,status,error){
		  $("#div1").html(error);
		}});
	  });
	});
	
    var ctx = document.getElementById("myChart").getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'horizontalBar',
        data: {
            labels: [],
			datasets: [{
                label: 'Smiles',
                data: [],
                backgroundColor: [
                ],
                borderColor: [
                ],
                borderWidth: 1
            },
			
			{
                label: 'Popularity',
                data: [],
                backgroundColor: [
                ],
                borderColor: [
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero:true
                    },
					barThickness : 30,
					stacked : true
                }],
				xAxes: [{
                    ticks: {
                        beginAtZero:true
                    },
					barThickness : 30,
					stacked : true
                }]
				
            }
        }
    });
	
	function addData(result) {
	    //chart, label, data
		//alert("Hi");
		myChart.clear();
		
		items = result.body.Items;
		items.sort((function(a, b){return a.score - b.score})).reverse().slice(1,10);
		
		for (i in items) {
			myChart.data.labels.push(items[i].UserId);
		}
		//$("#div1").html(label);

		 -->
		for (i in items) {
			myChart.data.datasets[0].data.push(items[i].score);
			myChart.data.datasets[0].backgroundColor.push(backgroundColor[0]);
			myChart.data.datasets[0].borderColor.push(borderColor[0]);
			
			myChart.data.datasets[1].data.push(items[i].seenWithPeople);
			myChart.data.datasets[1].backgroundColor.push(backgroundColor[9]);
			myChart.data.datasets[1].borderColor.push(borderColor[9]);
		}
		

		myChart.update();
    }

    </script>
  </body>
</html>
